flowchart LR
    %% External Entity
    User[User]

    %% Processes
    Frontend((Frontend<br/>Next.ts))
    Backend((Backend<br/>Next.ts API / Server Actions))
    Engine((Workflow Engine))

    %% Data Stores
    Supabase[(Supabase<br/>Auth + DB + Storage)]
    Reports[(Reports / Files)]
    Avatars[(Avatars Bucket)]

    %% External Service
    Groq[[Groq API<br/>Summarization]]

    %% Data Flows - Auth
    User -->|Login / Register| Frontend
    Frontend -->|Auth API Calls| Backend
    Backend -->|Auth Requests| Supabase
    Supabase -->|Session / User Data| Backend
    Backend -->|Session State| Frontend

    %% Workflows CRUD
    User -->|Create / Update / Delete Workflow| Frontend
    Frontend -->|Workflow API Calls| Backend
    Backend -->|Persist Workflow| Supabase
    Supabase -->|Saved Workflow Data| Backend
    Backend -->|Updated Workflow List| Frontend

    %% Workflow Execution
    Backend -->|Trigger Execution| Engine
    Engine -->|Summarization Request| Groq
    Groq -->|Summary Result| Engine
    Engine -->|Save Workflow State<br/>nodes, edges, settings| Supabase
    Engine -->|Generate Reports<br/>PDF, CSV| Reports
    Reports -->|Report Links| Engine
    Engine -->|Results: status, output| Backend
    Backend -->|Notify Frontend<br/>success / error| Frontend

    %% Filtering
    User -->|Search / Filter Workflows| Frontend
    Frontend -->|Filter in Zustand Store| Frontend

    %% Bulk Delete
    User -->|Bulk Delete Workflows| Frontend
    Frontend -->|Delete Requests| Backend
    Backend -->|Remove Records| Supabase
    Supabase -->|Confirm Deletion| Backend
    Backend -->|Updated Workflow List| Frontend

    %% Avatars
    User -->|Upload Avatar| Frontend
    Frontend -->|Send File| Backend
    Backend -->|Store Avatar| Avatars
    Avatars -->|Avatar URL| Backend
    Backend -->|Updated Profile| Frontend
    Frontend -->|Show Profile Avatar| User

    %% Final Outputs
    Backend -->|Processed Results<br/>Updated State| Frontend
    Frontend -->|Outputs: Reports, Emails, Summaries| User
